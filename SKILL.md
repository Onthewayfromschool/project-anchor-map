---
name: project-anchor-map
description: 为前端/全栈项目生成"锚点地图"，将页面URL、UI区域、交互行为映射到具体代码文件和行号。当用户说"帮我梳理项目结构"、"我想快速定位代码"、"生成项目地图"、"项目导航"时使用。
---

# 项目锚点地图生成器

## 目标

生成一份**从页面/UI 直接查到代码位置**的速查地图，帮助维护者快速定位问题代码，而不是生成传统的项目分析文档。

## 核心原则

1. **简洁优先**：不写长篇大论，每个板块用表格+ASCII图解决
2. **从用户视角出发**：按"我在页面上看到什么"组织，而非按代码目录组织
3. **每个板块必须包含**：一句话说明这个页面干什么 + 上下游跳转关系 + 可视化区域地图

## 生成流程

### 第1步：提取路由表

找到项目的路由配置文件（如 `ice.config.mts`、`router.ts`、`App.tsx` 等），输出路由总览表：

```
| URL 路径 | 页面文件 |
|---------|---------|
| /xxx    | src/pages/xxx/index.tsx |
```

### 第2步：梳理页面间跳转关系

搜索页面中的导航逻辑（`navigate`、`goto`、`Link`、`window.location`、`router.push` 等），画出页面间的跳转关系：

```
页面A
  ├─ 点击「按钮X」→ /页面B?参数=值
  └─ 点击「按钮Y」→ 不跳转，内嵌打开组件Z
```

标注跳转机制：URL 参数、props、store、内嵌子组件。

### 第3步：逐页面生成区域地图

对每个页面，按以下模板输出：

```markdown
## 页面名称（`/路由`）

**干什么**：一句话描述。上游：从哪来；下游：去哪里。

（ASCII 区域图）

| 区域 | 代码 |
|------|------|
| 区域名 | `src/xxx/index.tsx` |
```

#### ASCII 区域图规范

- 用 `┌─┬─┐├─┼─┤└─┴─┘│` 画框
- 每个框内标注区域名称和关键组件名
- 保持简洁，只展示一级可见区域，不展开组件内部

#### 示例

```
┌──────────┬──────────────────────┬────────────────┐
│ 侧边栏    │  主内容区              │  详情面板       │
│          │                      │               │
│ 导航列表   │  ┌────────────────┐  │  面板标题      │
│          │  │ 数据表格          │  │  面板内容      │
│          │  └────────────────┘  │               │
│          │  [分页]               │               │
│          │  ┌────────────────┐  │               │
│          │  │ 底部输入框       │  │               │
│          │  └────────────────┘  │               │
└──────────┴──────────────────────┴────────────────┘
```

### 第4步：State 管理速查

列出项目中的主要 Store/Context，标注各自管理的数据范围：

```
| Store | 文件 | 管什么 |
|-------|------|--------|
| useXxxStore | src/store/xxx.ts | 一句话描述 |
```

### 第5步：定位套路指引

在末尾附上定位问题的标准流程：

```
1. bug 在哪个页面？ → 看 URL → 查路由表 → 找到入口文件
2. bug 在页面哪个区域？ → 查区域地图 → 找到子组件文件
3. 把组件路径 + 截图/描述丢给 AI
```

## 输出格式要求

- 使用中文
- 不生成独立的 md 文件到项目中，直接在对话中输出
- 表格对齐，ASCII 图用等宽字符
- 每个页面板块控制在 20 行以内
- 不解释代码逻辑，只映射位置

## 探索策略

1. **路由文件**：优先搜索 `route`、`router`、`defineRoutes` 关键词
2. **页面入口**：读取 `src/pages/*/index.tsx` 或对应目录
3. **组件引用**：从页面入口的 import 语句追踪子组件路径
4. **跳转逻辑**：搜索 `navigate`、`goto`、`push`、`Link`、`href` 等
5. **Store 文件**：搜索 `create(`、`createStore`、`createContext` 等
6. **并行探索**：对独立的页面使用并行 agent 加速
